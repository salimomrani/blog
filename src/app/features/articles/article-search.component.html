<div class="mb-6">
  <!-- Search Bar -->
  <div class="flex flex-col gap-4">
    <!-- Text Search -->
    <div class="flex gap-2">
      <div class="flex-1 relative">
        <input
          type="text"
          [ngModel]="searchQuery()"
          (ngModelChange)="searchQuery.set($event)"
          (keypress)="onKeyPress($event)"
          placeholder="Rechercher par titre ou contenu..."
          class="w-full px-4 py-3 pl-12 pr-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition"
        />
        <svg
          class="absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
          />
        </svg>
      </div>

      <button
        (click)="onSearch()"
        [disabled]="!hasActiveFilters()"
        class="px-6 py-3 bg-purple-600 text-white font-semibold rounded-lg hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition duration-150"
      >
        Rechercher
      </button>

      @if (hasActiveFilters()) {
        <button
          (click)="onClear()"
          class="px-6 py-3 bg-gray-200 text-gray-700 font-semibold rounded-lg hover:bg-gray-300 transition duration-150"
        >
          Effacer
        </button>
      }
    </div>

    <!-- Filters Row -->
    <div class="flex gap-4">
      <!-- Category Filter -->
      <div class="flex-1">
        <label class="block text-sm font-medium text-gray-700 mb-1" for="category-select">
          Cat√©gorie
        </label>
        <select
          [ngModel]="selectedCategoryId()"
          (ngModelChange)="selectedCategoryId.set($event === '' ? undefined : +$event)"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition"
          [disabled]="isLoadingFilters()"
          id="category-select"
        >
          <option value="">Toutes les cat√©gories</option>
          @for (category of categories(); track category.id) {
            <option [value]="category.id">{{ category.name }}</option>
          }
        </select>
      </div>

      <!-- Tag Filter -->
      <div class="flex-1">
        <label class="block text-sm font-medium text-gray-700 mb-1" for="tag-select">
          Tag
        </label>
        <select
          [ngModel]="selectedTagId()"
          (ngModelChange)="selectedTagId.set($event === '' ? undefined : +$event)"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition"
          [disabled]="isLoadingFilters()"
          id="tag-select"
        >
          <option value="">Tous les tags</option>
          @for (tag of tags(); track tag.id) {
            <option [value]="tag.id">#{{ tag.name }}</option>
          }
        </select>
      </div>
    </div>

    <!-- Active Filters Display -->
    @if (hasActiveFilters()) {
      <div class="flex flex-wrap gap-2 items-center">
        <span class="text-sm text-gray-600 font-medium">Filtres actifs:</span>

        @if (searchQuery().trim()) {
          <span class="inline-flex items-center px-3 py-1 rounded-full text-sm bg-purple-100 text-purple-800">
            <svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
            "{{ searchQuery() }}"
          </span>
        }

        @if (selectedCategoryId()) {
          <span class="inline-flex items-center px-3 py-1 rounded-full text-sm bg-purple-100 text-purple-800">
            üìÅ {{ selectedCategory()?.name }}
          </span>
        }

        @if (selectedTagId()) {
          <span class="inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800">
            #{{ selectedTag()?.name }}
          </span>
        }
      </div>
    }
  </div>
</div>
